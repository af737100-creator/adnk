<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تعليمي - منصة التعلم التفاعلي</title>
    <meta name="description" content="حوّل مقاطع اليوتيوب التعليمية إلى تجربة تعلم تفاعلية مع أسئلة واختبارات وشروحات إضافية">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== جميع التنسيقات هنا ===== */
        *{margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, sans-serif;}
        body{background:#f8fafc; color:#1e293b; direction:rtl; line-height:1.6;}
        .container{max-width:1200px; margin:0 auto; padding:0 20px;}
        .navbar{background:white; box-shadow:0 2px 10px rgba(0,0,0,0.05); padding:15px 0; position:sticky; top:0; z-index:1000;}
        .navbar .container{display:flex; justify-content:space-between; align-items:center;}
        .logo{font-size:1.8rem; font-weight:bold; color:#4361ee; cursor:pointer; background:none; border:none;}
        .nav-links{display:flex; gap:20px; align-items:center;}
        .nav-links button{background:none; border:none; font-size:1rem; cursor:pointer; padding:8px 16px; border-radius:8px; transition:0.2s;}
        .btn-login{border:2px solid #4361ee; color:#4361ee; background:white;}
        .btn-signup{background:#4361ee; color:white;}
        .btn-login:hover{background:#eef2ff;}
        .btn-signup:hover{background:#3a0ca3;}
        .btn{background:#4361ee; color:white; border:none; padding:12px 30px; border-radius:10px; font-size:1rem; font-weight:600; cursor:pointer; transition:0.2s; display:inline-block;}
        .btn-outline{background:white; color:#4361ee; border:2px solid #4361ee;}
        .btn:hover,.btn-outline:hover{transform:translateY(-2px); box-shadow:0 10px 20px rgba(67,97,238,0.2);}
        .btn-outline:hover{background:#eef2ff;}
        .hero{padding:80px 0; background:linear-gradient(135deg,#eef2ff,#ffffff); text-align:center;}
        .hero h1{font-size:2.8rem; margin-bottom:20px; color:#0f172a;}
        .hero p{font-size:1.2rem; color:#475569; max-width:700px; margin:0 auto 30px;}
        .section-title{font-size:2.2rem; margin:60px 0 30px; text-align:center; color:#0f172a;}
        .features-grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:30px; margin:40px 0;}
        .feature-card{background:white; padding:30px; border-radius:20px; box-shadow:0 5px 20px rgba(0,0,0,0.03); border:1px solid #e2e8f0; text-align:center; transition:0.2s;}
        .feature-card:hover{border-color:#4361ee; transform:translateY(-5px);}
        .feature-icon{font-size:2.5rem; color:#4361ee; margin-bottom:15px;}
        .steps{display:grid; grid-template-columns:repeat(4,1fr); gap:20px; margin:40px 0;}
        .step{text-align:center;}
        .step-number{width:60px; height:60px; background:#4361ee; color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.8rem; font-weight:bold; margin:0 auto 20px;}
        .pricing-grid{display:grid; grid-template-columns:repeat(3,1fr); gap:30px; margin:40px 0;}
        .pricing-card{background:white; padding:40px 30px; border-radius:20px; border:1px solid #e2e8f0; position:relative; text-align:center;}
        .pricing-card.popular{border:2px solid #4361ee; transform:scale(1.05);}
        .popular-badge{position:absolute; top:-12px; left:50%; transform:translateX(-50%); background:#4361ee; color:white; padding:5px 20px; border-radius:20px; font-size:0.9rem;}
        .price{font-size:2.5rem; font-weight:bold; margin:20px 0;}
        .price small{font-size:1rem; color:#64748b;}
        .pricing-features{list-style:none; margin:30px 0; text-align:right;}
        .pricing-features li{padding:10px 0; border-bottom:1px solid #e2e8f0; display:flex; align-items:center; gap:10px;}
        .pricing-features i.fa-check{color:#4ade80;}
        .pricing-features i.fa-times{color:#ef4444;}
        .disabled{opacity:0.5;}
        .dashboard-layout{display:flex; gap:30px; margin:30px 0;}
        .sidebar{width:280px; background:white; padding:25px; border-radius:20px; box-shadow:0 5px 15px rgba(0,0,0,0.03);}
        .sidebar h3{margin-bottom:20px; color:#4361ee;}
        .sidebar button{display:block; width:100%; padding:15px; margin-bottom:8px; border:none; background:none; border-radius:12px; font-size:1rem; text-align:right; cursor:pointer; transition:0.2s; color:#334155;}
        .sidebar button:hover,.sidebar button.active{background:#eef2ff; color:#4361ee; font-weight:600;}
        .main-panel{flex:1; background:white; padding:30px; border-radius:20px; box-shadow:0 5px 15px rgba(0,0,0,0.03);}
        .stats-grid{display:grid; grid-template-columns:repeat(4,1fr); gap:20px; margin:30px 0;}
        .stat-card{background:#f8fafc; padding:20px; border-radius:16px; text-align:center;}
        .stat-card h2{font-size:2.2rem; color:#4361ee; margin-bottom:5px;}
        .form-group{margin-bottom:20px;}
        .form-group label{display:block; margin-bottom:8px; font-weight:500; color:#1e293b;}
        .form-group input,.form-group textarea,.form-group select{width:100%; padding:12px; border:2px solid #e2e8f0; border-radius:10px; font-size:1rem;}
        .form-group input:focus,.form-group textarea:focus,.form-group select:focus{border-color:#4361ee; outline:none;}
        .video-container{position:relative; width:100%; background:#000; border-radius:16px; overflow:hidden; margin:20px 0;}
        .video-wrapper{position:relative; padding-top:56.25%;}
        .video-wrapper iframe{position:absolute; top:0; left:0; width:100%; height:100%; border:none;}
        .interaction-point{position:absolute; width:40px; height:40px; background:rgba(67,97,238,0.8); border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-size:1.2rem; cursor:pointer; animation:pulse 2s infinite;}
        .interaction-point:hover{background:#4361ee; transform:scale(1.1);}
        @keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(67,97,238,0.7);}50%{box-shadow:0 0 0 10px rgba(67,97,238,0);}}
        .interactions-list{margin-top:30px; background:#f8fafc; border-radius:16px; padding:20px;}
        .interaction-item{display:flex; align-items:center; gap:15px; padding:15px; background:white; border-radius:12px; margin-bottom:10px; border:1px solid #e2e8f0;}
        .interaction-icon{width:40px; height:40px; background:#eef2ff; color:#4361ee; border-radius:50%; display:flex; align-items:center; justify-content:center;}
        .interaction-actions{display:flex; gap:10px; margin-right:auto;}
        .interaction-actions button{background:none; border:none; cursor:pointer; color:#64748b; font-size:1.1rem;}
        .interaction-actions button:hover{color:#4361ee;}
        .modal{position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); display:none; align-items:center; justify-content:center; z-index:2000;}
        .modal.active{display:flex;}
        .modal-content{background:white; border-radius:20px; padding:30px; max-width:500px; width:90%; max-height:80vh; overflow-y:auto;}
        footer{background:#1e293b; color:white; padding:60px 0 20px; margin-top:60px;}
        .footer-content{display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:40px; margin-bottom:40px;}
        .footer-section h3{margin-bottom:20px; color:white;}
        .footer-section ul{list-style:none;}
        .footer-section ul li{margin-bottom:10px;}
        .footer-section a{color:#cbd5e1; text-decoration:none;}
        .footer-section a:hover{color:#4cc9f0;}
        .footer-bottom{text-align:center; padding-top:20px; border-top:1px solid #334155; color:#94a3b8;}
        .hamburger{display:none; flex-direction:column; cursor:pointer; background:none; border:none;}
        .hamburger span{width:25px; height:3px; background:#1e293b; margin:3px 0; border-radius:3px;}
        @media(max-width:768px){
            .hero h1{font-size:2rem;}
            .steps{grid-template-columns:1fr;}
            .pricing-grid{grid-template-columns:1fr;}
            .dashboard-layout{flex-direction:column;}
            .sidebar{width:100%;}
            .stats-grid{grid-template-columns:repeat(2,1fr);}
            .hamburger{display:flex;}
            .nav-links{display:none; flex-direction:column; position:absolute; top:70px; right:0; width:100%; background:white; padding:20px; box-shadow:0 5px 10px rgba(0,0,0,0.1); z-index:999;}
            .nav-links.show{display:flex;}
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // ============================================
        // البيانات الأساسية (محاكاة قاعدة البيانات)
        // ============================================
        const DB = {
            user: { id: 1, name: 'محمد أحمد', email: 'teacher@example.com' },
            courses: [
                { id: 1, title: 'مقدمة في البرمجة', students: 45, status: 'published', interactions: [] },
                { id: 2, title: 'تعلم JavaScript', students: 78, status: 'published', interactions: [] },
                { id: 3, title: 'أساسيات HTML', students: 32, status: 'draft', interactions: [] }
            ],
            stats: { courses: 12, students: 245, completion: 78, engagement: 92 }
        };

        // الصفحة الحالية
        let currentPage = 'home';

        // ============================================
        // دوال عرض الصفحات
        // ============================================
        function renderPage(page) {
            currentPage = page;
            const app = document.getElementById('app');
            let html = '';

            if (page === 'home') {
                html = renderHome();
            } else if (page === 'dashboard') {
                if (!isLoggedIn()) {
                    alert('الرجاء تسجيل الدخول أولاً');
                    html = renderHome();
                } else {
                    html = renderDashboard();
                }
            } else if (page === 'create') {
                if (!isLoggedIn()) {
                    alert('الرجاء تسجيل الدخول أولاً');
                    html = renderHome();
                } else {
                    html = renderCreateCourse();
                }
            } else if (page === 'course') {
                html = renderCourseViewer();
            } else if (page === 'settings') {
                if (!isLoggedIn()) {
                    alert('الرجاء تسجيل الدخول أولاً');
                    html = renderHome();
                } else {
                    html = renderSettings();
                }
            }

            app.innerHTML = html;
            window.scrollTo(0, 0);
        }

        // التحقق من تسجيل الدخول (محاكاة)
        function isLoggedIn() {
            return localStorage.getItem('ta3lemi_user') !== null;
        }

        // ============================================
        // الصفحة الرئيسية
        // ============================================
        function renderHome() {
            return `
                <header>
                    <nav class="navbar">
                        <div class="container">
                            <button class="logo" onclick="renderPage('home')">تعليمي</button>
                            <button class="hamburger" onclick="document.querySelector('.nav-links').classList.toggle('show')">☰</button>
                            <div class="nav-links">
                                <button class="btn-login" onclick="showLoginModal()">تسجيل الدخول</button>
                                <button class="btn-signup" onclick="showSignupModal()">إنشاء حساب</button>
                            </div>
                        </div>
                    </nav>
                </header>
                <section class="hero">
                    <div class="container">
                        <h1>حوّل مقاطع اليوتيوب التعليمية إلى تجربة تعلم تفاعلية</h1>
                        <p>أضف أسئلة، اختبارات، وشروحات تفاعلية على أي فيديو تعليمي بدون إعادة التسجيل. منصة متكاملة للمعلمين والطلاب.</p>
                        <button class="btn" onclick="showSignupModal()">ابدأ مجاناً</button>
                    </div>
                </section>
                <div class="container">
                    <h2 class="section-title">مميزات منصتنا الفريدة</h2>
                    <div class="features-grid">
                        <div class="feature-card"><i class="fas fa-question-circle feature-icon"></i><h3>أسئلة تفاعلية</h3><p>أضف أسئلة في أي نقطة من الفيديو مع تصحيح فوري وتغذية راجعة.</p></div>
                        <div class="feature-card"><i class="fas fa-clipboard-check feature-icon"></i><h3>اختبارات قصيرة</h3><p>اختبارات متعددة الخيارات مع تحليلات دقيقة.</p></div>
                        <div class="feature-card"><i class="fas fa-lightbulb feature-icon"></i><h3>شروحات إضافية</h3><p>موارد وروابط تعليمية عند نقاط محددة.</p></div>
                        <div class="feature-card"><i class="fas fa-chart-line feature-icon"></i><h3>تحليلات متقدمة</h3><p>تتبع تقدم الطلاب وإحصائيات دقيقة.</p></div>
                        <div class="feature-card"><i class="fas fa-users feature-icon"></i><h3>تعليم تعاوني</h3><p>غرف دراسية افتراضية وسبورة تفاعلية.</p></div>
                        <div class="feature-card"><i class="fas fa-mobile-alt feature-icon"></i><h3>متوافق مع الأجهزة</h3><p>تصميم متجاوب للهواتف والأجهزة اللوحية.</p></div>
                    </div>
                    <h2 class="section-title">كيف تعمل المنصة؟</h2>
                    <div class="steps">
                        <div class="step"><div class="step-number">1</div><h3>أدخل رابط الفيديو</h3><p>انسخ رابط أي فيديو يوتيوب.</p></div>
                        <div class="step"><div class="step-number">2</div><h3>أضف التفاعلات</h3><p>ضع أسئلة وشروحات في النقاط المناسبة.</p></div>
                        <div class="step"><div class="step-number">3</div><h3>شارك الدرس</h3><p>احصل على رابط فريد للمشاركة.</p></div>
                        <div class="step"><div class="step-number">4</div><h3>تابع التقدم</h3><p>راقب أداء طلابك عبر التقارير.</p></div>
                    </div>
                    <h2 class="section-title">خطط الأسعار</h2>
                    <div class="pricing-grid">
                        <div class="pricing-card">
                            <h3>مجاني</h3>
                            <div class="price">$0 <small>/شهر</small></div>
                            <ul class="pricing-features">
                                <li><i class="fas fa-check"></i> 3 دروس تفاعلية</li>
                                <li><i class="fas fa-check"></i> 10 طلاب لكل درس</li>
                                <li><i class="fas fa-check"></i> تفاعلات أساسية</li>
                                <li class="disabled"><i class="fas fa-times"></i> تحليلات متقدمة</li>
                                <li class="disabled"><i class="fas fa-times"></i> غرف تفاعلية</li>
                            </ul>
                            <button class="btn btn-outline" onclick="showSignupModal()">ابدأ مجاناً</button>
                        </div>
                        <div class="pricing-card popular">
                            <div class="popular-badge">الأكثر شهرة</div>
                            <h3>احترافي</h3>
                            <div class="price">$29 <small>/شهر</small></div>
                            <ul class="pricing-features">
                                <li><i class="fas fa-check"></i> دروس غير محدودة</li>
                                <li><i class="fas fa-check"></i> طلاب غير محدودين</li>
                                <li><i class="fas fa-check"></i> جميع التفاعلات</li>
                                <li><i class="fas fa-check"></i> تحليلات متقدمة</li>
                                <li><i class="fas fa-check"></i> غرف تفاعلية</li>
                            </ul>
                            <button class="btn" onclick="showSignupModal()">اختر الخطة</button>
                        </div>
                        <div class="pricing-card">
                            <h3>مؤسسات</h3>
                            <div class="price">$99 <small>/شهر</small></div>
                            <ul class="pricing-features">
                                <li><i class="fas fa-check"></i> جميع ميزات الخطة الاحترافية</li>
                                <li><i class="fas fa-check"></i> لوحة تحكم للمؤسسة</li>
                                <li><i class="fas fa-check"></i> إدارة حسابات متعددة</li>
                                <li><i class="fas fa-check"></i> تكامل مع LMS</li>
                                <li><i class="fas fa-check"></i> تدريب ودعم مخصص</li>
                            </ul>
                            <button class="btn btn-outline" onclick="alert('اتصل بنا')">اتصل بنا</button>
                        </div>
                    </div>
                </div>
                <footer>
                    <div class="container">
                        <div class="footer-content">
                            <div class="footer-section"><h3>تعليمي</h3><p>منصة التعلم التفاعلي الأولى.</p></div>
                            <div class="footer-section"><h3>روابط سريعة</h3><ul><li><a href="#" onclick="renderPage('home'); return false;">الرئيسية</a></li><li><a href="#" onclick="renderPage('dashboard'); return false;">لوحة التحكم</a></li></ul></div>
                            <div class="footer-section"><h3>تواصل معنا</h3><ul><li><i class="fas fa-envelope"></i> support@ta3lemi.com</li><li><i class="fas fa-phone"></i> +966 123 456 789</li></ul></div>
                        </div>
                        <div class="footer-bottom"><p>© 2026 تعليمي. جميع الحقوق محفوظة.</p></div>
                    </div>
                </footer>
            `;
        }

        // ============================================
        // لوحة التحكم
        // ============================================
        function renderDashboard() {
            const user = JSON.parse(localStorage.getItem('ta3lemi_user') || '{}');
            return `
                <header>
                    <nav class="navbar">
                        <div class="container">
                            <button class="logo" onclick="renderPage('home')">تعليمي</button>
                            <button class="hamburger" onclick="document.querySelector('.nav-links').classList.toggle('show')">☰</button>
                            <div class="nav-links">
                                <span style="color:#4361ee;">${user.name || 'مستخدم'}</span>
                                <button class="btn-login" onclick="logout()">تسجيل خروج</button>
                            </div>
                        </div>
                    </nav>
                </header>
                <div class="dashboard-layout container">
                    <aside class="sidebar">
                        <h3>تعليمي</h3>
                        <button class="active" onclick="renderPage('dashboard')">لوحة التحكم</button>
                        <button onclick="renderPage('create')">إنشاء درس جديد</button>
                        <button onclick="renderPage('settings')">الإعدادات</button>
                    </aside>
                    <main class="main-panel">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <h1>لوحة التحكم</h1>
                            <button class="btn" onclick="renderPage('create')">+ درس جديد</button>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card"><h2>${DB.stats.courses}</h2><p>إجمالي الدروس</p></div>
                            <div class="stat-card"><h2>${DB.stats.students}</h2><p>الطلاب</p></div>
                            <div class="stat-card"><h2>${DB.stats.completion}%</h2><p>معدل الإكمال</p></div>
                            <div class="stat-card"><h2>${DB.stats.engagement}%</h2><p>معدل التفاعل</p></div>
                        </div>
                        <h2>الدروس الأخيرة</h2>
                        <table style="width:100%; border-collapse:collapse; margin-top:20px;">
                            <thead><tr><th>العنوان</th><th>الطلاب</th><th>الحالة</th></tr></thead>
                            <tbody>
                                ${DB.courses.map(c => `
                                    <tr>
                                        <td><a href="#" onclick="renderPage('course'); return false;">${c.title}</a></td>
                                        <td>${c.students}</td>
                                        <td><span style="color:${c.status==='published'?'#4ade80':'#f59e0b'};">${c.status==='published'?'منشور':'مسودة'}</span></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </main>
                </div>
            `;
        }

        // ============================================
        // إنشاء درس جديد (مع تفاعلات)
        // ============================================
        let tempInteractions = [];

        function renderCreateCourse() {
            return `
                <header>
                    <nav class="navbar">
                        <div class="container">
                            <button class="logo" onclick="renderPage('home')">تعليمي</button>
                            <button class="hamburger" onclick="document.querySelector('.nav-links').classList.toggle('show')">☰</button>
                            <div class="nav-links">
                                <span style="color:#4361ee;">${JSON.parse(localStorage.getItem('ta3lemi_user') || '{}').name || 'مستخدم'}</span>
                                <button class="btn-login" onclick="logout()">تسجيل خروج</button>
                            </div>
                        </div>
                    </nav>
                </header>
                <div class="dashboard-layout container">
                    <aside class="sidebar">
                        <h3>تعليمي</h3>
                        <button onclick="renderPage('dashboard')">لوحة التحكم</button>
                        <button class="active" onclick="renderPage('create')">إنشاء درس جديد</button>
                        <button onclick="renderPage('settings')">الإعدادات</button>
                    </aside>
                    <main class="main-panel">
                        <button class="btn-outline" style="margin-bottom:20px;" onclick="renderPage('dashboard')">← رجوع</button>
                        <h1>إنشاء درس جديد</h1>
                        
                        <div class="form-group">
                            <label>عنوان الدرس</label>
                            <input type="text" id="courseTitle" placeholder="مثال: مقدمة في البرمجة">
                        </div>
                        <div class="form-group">
                            <label>وصف الدرس</label>
                            <textarea id="courseDesc" rows="3" placeholder="صف محتوى الدرس..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>رابط فيديو يوتيوب</label>
                            <div style="display:flex; gap:10px;">
                                <input type="url" id="youtubeUrl" placeholder="https://youtube.com/watch?v=..." style="flex:1;">
                                <button class="btn" onclick="previewVideo()">معاينة</button>
                            </div>
                        </div>
                        <div id="videoPreview" style="display:none; margin:20px 0; padding:20px; background:#f8fafc; border-radius:12px; text-align:center;">
                            <img id="thumbnail" src="" alt="صورة الفيديو" style="max-width:100%; border-radius:8px;">
                        </div>

                        <h2 style="margin-top:40px;">التفاعلات</h2>
                        <div style="display:flex; gap:10px; margin-bottom:20px;">
                            <button class="btn-outline" onclick="showQuestionModal()">+ إضافة سؤال</button>
                            <button class="btn-outline" onclick="showQuizModal()">+ إضافة اختبار</button>
                            <button class="btn-outline" onclick="showExplanationModal()">+ إضافة شرح</button>
                        </div>

                        <div id="interactionsList" class="interactions-list">
                            ${tempInteractions.length === 0 ? '<p>لا توجد تفاعلات بعد. أضف أول تفاعل!</p>' : ''}
                        </div>

                        <button class="btn" style="width:100%; margin-top:30px;" onclick="saveCourse()">حفظ الدرس</button>
                    </main>
                </div>

                <!-- نافذة إضافة سؤال -->
                <div class="modal" id="questionModal">
                    <div class="modal-content">
                        <h3>إضافة سؤال</h3>
                        <div class="form-group">
                            <label>الوقت (بالثواني)</label>
                            <input type="number" id="qTime" min="0" value="0">
                        </div>
                        <div class="form-group">
                            <label>نص السؤال</label>
                            <textarea id="qText" rows="2" placeholder="أدخل السؤال..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>الخيارات</label>
                            <div id="qOptions">
                                <div style="display:flex; gap:10px; margin-bottom:10px;">
                                    <input type="text" placeholder="الخيار الأول" style="flex:1;">
                                    <input type="radio" name="correct" value="0">
                                </div>
                                <div style="display:flex; gap:10px; margin-bottom:10px;">
                                    <input type="text" placeholder="الخيار الثاني" style="flex:1;">
                                    <input type="radio" name="correct" value="1">
                                </div>
                            </div>
                            <button class="btn-outline" onclick="addOption()">+ إضافة خيار</button>
                        </div>
                        <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:20px;">
                            <button class="btn-outline" onclick="closeModal('questionModal')">إلغاء</button>
                            <button class="btn" onclick="saveQuestion()">حفظ</button>
                        </div>
                    </div>
                </div>

                <!-- نافذة إضافة اختبار -->
                <div class="modal" id="quizModal">
                    <div class="modal-content">
                        <h3>إضافة اختبار</h3>
                        <div class="form-group">
                            <label>الوقت (بالثواني)</label>
                            <input type="number" id="quizTime" min="0" value="0">
                        </div>
                        <div class="form-group">
                            <label>عنوان الاختبار</label>
                            <input type="text" id="quizTitle" placeholder="مثال: اختبار الفصل الأول">
                        </div>
                        <div class="form-group">
                            <label>عدد الأسئلة</label>
                            <input type="number" id="quizCount" min="1" max="10" value="3">
                        </div>
                        <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:20px;">
                            <button class="btn-outline" onclick="closeModal('quizModal')">إلغاء</button>
                            <button class="btn" onclick="saveQuiz()">حفظ</button>
                        </div>
                    </div>
                </div>

                <!-- نافذة إضافة شرح -->
                <div class="modal" id="explanationModal">
                    <div class="modal-content">
                        <h3>إضافة شرح إضافي</h3>
                        <div class="form-group">
                            <label>الوقت (بالثواني)</label>
                            <input type="number" id="expTime" min="0" value="0">
                        </div>
                        <div class="form-group">
                            <label>نص الشرح</label>
                            <textarea id="expText" rows="4" placeholder="أدخل الشرح هنا..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>رابط إضافي (اختياري)</label>
                            <input type="url" id="expUrl" placeholder="https://example.com">
                        </div>
                        <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:20px;">
                            <button class="btn-outline" onclick="closeModal('explanationModal')">إلغاء</button>
                            <button class="btn" onclick="saveExplanation()">حفظ</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // ============================================
        // صفحة مشاهدة الدرس
        // ============================================
        function renderCourseViewer() {
            return `
                <header>
                    <nav class="navbar">
                        <div class="container">
                            <button class="logo" onclick="renderPage('home')">تعليمي</button>
                            <button class="hamburger" onclick="document.querySelector('.nav-links').classList.toggle('show')">☰</button>
                            <div class="nav-links">
                                <button class="btn-login" onclick="renderPage('dashboard')">لوحة التحكم</button>
                                <button class="btn-signup" onclick="renderPage('home')">الرئيسية</button>
                            </div>
                        </div>
                    </nav>
                </header>
                <div class="container" style="margin-top:30px;">
                    <button class="btn-outline" onclick="renderPage('dashboard')">← رجوع</button>
                    <h1 style="margin:20px 0;">مقدمة في البرمجة</h1>
                    <div class="video-container">
                        <div class="video-wrapper">
                            <iframe id="player" src="https://www.youtube.com/embed/dQw4w9WgXcQ?enablejsapi=1" frameborder="0" allowfullscreen></iframe>
                        </div>
                        <div id="interactionOverlay" style="position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none;">
                            <!-- نقاط التفاعل ستضاف هنا -->
                        </div>
                    </div>
                    <div style="margin-top:30px;">
                        <h2>التفاعلات في هذا الدرس</h2>
                        <div class="interactions-list" id="courseInteractions"></div>
                    </div>
                </div>
            `;
        }

        // ============================================
        // الإعدادات
        // ============================================
        function renderSettings() {
            const user = JSON.parse(localStorage.getItem('ta3lemi_user') || '{}');
            return `
                <header>
                    <nav class="navbar">
                        <div class="container">
                            <button class="logo" onclick="renderPage('home')">تعليمي</button>
                            <button class="hamburger" onclick="document.querySelector('.nav-links').classList.toggle('show')">☰</button>
                            <div class="nav-links">
                                <span style="color:#4361ee;">${user.name || 'مستخدم'}</span>
                                <button class="btn-login" onclick="logout()">تسجيل خروج</button>
                            </div>
                        </div>
                    </nav>
                </header>
                <div class="dashboard-layout container">
                    <aside class="sidebar">
                        <h3>تعليمي</h3>
                        <button onclick="renderPage('dashboard')">لوحة التحكم</button>
                        <button onclick="renderPage('create')">إنشاء درس</button>
                        <button class="active" onclick="renderPage('settings')">الإعدادات</button>
                    </aside>
                    <main class="main-panel">
                        <h1>الإعدادات</h1>
                        <div class="form-group">
                            <label>الاسم الكامل</label>
                            <input type="text" id="userName" value="${user.name || ''}">
                        </div>
                        <div class="form-group">
                            <label>البريد الإلكتروني</label>
                            <input type="email" id="userEmail" value="${user.email || ''}">
                        </div>
                        <button class="btn" onclick="saveSettings()">حفظ التغييرات</button>
                    </main>
                </div>
            `;
        }

        // ============================================
        // دوال التفاعل
        // ============================================
        function showLoginModal() {
            const email = prompt('البريد الإلكتروني:');
            const password = prompt('كلمة المرور:');
            if (email && password) {
                // محاكاة تسجيل دخول ناجح
                localStorage.setItem('ta3lemi_user', JSON.stringify({
                    name: email.split('@')[0],
                    email: email
                }));
                alert('✅ تم تسجيل الدخول بنجاح');
                renderPage('dashboard');
            }
        }

        function showSignupModal() {
            const name = prompt('الاسم الكامل:');
            const email = prompt('البريد الإلكتروني:');
            const password = prompt('كلمة المرور:');
            if (name && email && password) {
                localStorage.setItem('ta3lemi_user', JSON.stringify({ name, email }));
                alert('✅ تم إنشاء الحساب بنجاح');
                renderPage('dashboard');
            }
        }

        function logout() {
            localStorage.removeItem('ta3lemi_user');
            renderPage('home');
        }

        function saveSettings() {
            const name = document.getElementById('userName')?.value;
            const email = document.getElementById('userEmail')?.value;
            if (name && email) {
                localStorage.setItem('ta3lemi_user', JSON.stringify({ name, email }));
                alert('✅ تم حفظ الإعدادات');
                renderPage('dashboard');
            }
        }

        function previewVideo() {
            const url = document.getElementById('youtubeUrl').value;
            const videoId = extractYouTubeId(url);
            if (!videoId) {
                alert('❌ رابط يوتيوب غير صالح');
                return;
            }
            document.getElementById('thumbnail').src = `https://img.youtube.com/vi/${videoId}/0.jpg`;
            document.getElementById('videoPreview').style.display = 'block';
        }

        function extractYouTubeId(url) {
            const patterns = [
                /(?:youtube\.com\/watch\?v=)([^&]+)/,
                /(?:youtu\.be\/)([^?]+)/,
                /(?:youtube\.com\/embed\/)([^?]+)/
            ];
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match) return match[1];
            }
            return null;
        }

        function showQuestionModal() {
            document.getElementById('questionModal')?.classList.add('active');
        }

        function showQuizModal() {
            document.getElementById('quizModal')?.classList.add('active');
        }

        function showExplanationModal() {
            document.getElementById('explanationModal')?.classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id)?.classList.remove('active');
        }

        function addOption() {
            const container = document.getElementById('qOptions');
            const count = container.children.length;
            const div = document.createElement('div');
            div.style.display = 'flex';
            div.style.gap = '10px';
            div.style.marginBottom = '10px';
            div.innerHTML = `
                <input type="text" placeholder="الخيار ${count+1}" style="flex:1;">
                <input type="radio" name="correct" value="${count}">
            `;
            container.appendChild(div);
        }

        function saveQuestion() {
            const time = document.getElementById('qTime').value;
            const text = document.getElementById('qText').value;
            const options = [];
            document.querySelectorAll('#qOptions input[type="text"]').forEach(input => options.push(input.value));
            const correct = document.querySelector('input[name="correct"]:checked')?.value;

            if (!text || options.length < 2 || correct === undefined) {
                alert('❌ يرجى ملء جميع الحقول');
                return;
            }

            tempInteractions.push({
                id: Date.now(),
                type: 'سؤال',
                time: parseInt(time),
                content: text,
                options: options,
                correct: parseInt(correct)
            });
            updateInteractionsList();
            closeModal('questionModal');
        }

        function saveQuiz() {
            const time = document.getElementById('quizTime').value;
            const title = document.getElementById('quizTitle').value;
            const count = document.getElementById('quizCount').value;

            if (!title) {
                alert('❌ يرجى إدخال عنوان الاختبار');
                return;
            }

            tempInteractions.push({
                id: Date.now(),
                type: 'اختبار',
                time: parseInt(time),
                title: title,
                questions: parseInt(count)
            });
            updateInteractionsList();
            closeModal('quizModal');
        }

        function saveExplanation() {
            const time = document.getElementById('expTime').value;
            const text = document.getElementById('expText').value;
            const url = document.getElementById('expUrl').value;

            if (!text) {
                alert('❌ يرجى إدخال نص الشرح');
                return;
            }

            tempInteractions.push({
                id: Date.now(),
                type: 'شرح',
                time: parseInt(time),
                content: text,
                url: url
            });
            updateInteractionsList();
            closeModal('explanationModal');
        }

        function updateInteractionsList() {
            const list = document.getElementById('interactionsList');
            if (!list) return;

            if (tempInteractions.length === 0) {
                list.innerHTML = '<p>لا توجد تفاعلات بعد. أضف أول تفاعل!</p>';
                return;
            }

            let html = '';
            tempInteractions.sort((a, b) => a.time - b.time).forEach(i => {
                const timeStr = Math.floor(i.time/60) + ':' + (i.time%60).toString().padStart(2,'0');
                let icon = 'fa-question-circle';
                let color = '#4361ee';
                if (i.type === 'اختبار') { icon = 'fa-clipboard-check'; color = '#4ade80'; }
                else if (i.type === 'شرح') { icon = 'fa-lightbulb'; color = '#f59e0b'; }

                html += `
                    <div class="interaction-item">
                        <div class="interaction-icon"><i class="fas ${icon}" style="color:${color};"></i></div>
                        <div>
                            <strong>${i.type}</strong>
                            <p style="font-size:0.9rem; color:#666;">الوقت: ${timeStr}</p>
                        </div>
                        <div class="interaction-actions">
                            <button onclick="deleteTempInteraction(${i.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                `;
            });
            list.innerHTML = html;
        }

        function deleteTempInteraction(id) {
            tempInteractions = tempInteractions.filter(i => i.id !== id);
            updateInteractionsList();
        }

        function saveCourse() {
            const title = document.getElementById('courseTitle')?.value;
            if (!title) {
                alert('❌ الرجاء إدخال عنوان الدرس');
                return;
            }
            // هنا يمكن حفظ الدورة مع التفاعلات في قاعدة بيانات حقيقية
            alert('✅ تم حفظ الدرس بنجاح مع ' + tempInteractions.length + ' تفاعل');
            tempInteractions = [];
            renderPage('dashboard');
        }

        // بدء التطبيق
        window.onload = () => renderPage('home');
    </script>
</body>
</html>